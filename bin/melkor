#!/usr/bin/env node --harmony
var commander = require('commander'),
  melkor = require('../index'),
  co = require('co');

var dataFolder = process.cwd();


commander
  .option('-p, --port <num>', 'Port number (Default: 4567)', 4567)
  .option('-t, --title <title>', 'Wiki title (Default: Wiki)', 'Wiki')
  .parse(process.argv);

var options = {
  baseURL: 'http://localhost:' + commander.port,
  port: commander.port,
  title: commander.title
};


co(melkor.init)(dataFolder, options, function(err) {
  if (err) {
    return console.error(err.stack);
  }

  console.log('Melkor (PID: ' + process.pid + ') started in: ' + dataFolder);
});
